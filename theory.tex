%!TEX root =  index.tex

\section{Theory}


% TODO: wofür brauchen wir das?
\begin{lemma}
Let $f \colon \HalfPlane_2 \rightarrow \C$ be a Hermitian modular form of weight $k$. Let $S \in \PM_2(\curlO)$.
Then, $\tau \mapsto f(S \tau) \colon \HalfPlane_1 \subseteq \C \rightarrow \C$ is an Elliptic modular form of weight $2k$ to $\Gamma_0(l)$, where $l$ is the denominator of $S^{-1}$.  %for some matrix $S \in \M_2(\Z)$ with $\Gamma(S) \subseteq \SL_2(\Z)$.
\proof
Define $\Gamma^H := \Sp_2(\curlO)$ as the translation group for $f$.
%not needed?
%Then, we can verify that
%\[ M := \SimpleMatrix{1_2}{B}{}{1_2} \in \Gamma^H, \quad B \in \Her_2(\curlO) . \]
Let $\tau \in \HalfPlane_1$. With $S = [s,t,u] \in \PM_2(\C)$ we have
\begin{align*}
\Im(S\tau) \quad = \quad& \frac{1}{2i} \left( S \tau - \overline{S}^T \overline{\tau} \right) \\
= \quad & \frac{1}{2i} S (\tau - \overline{\tau}) \\
= \quad & \frac{1}{2i} S \cdot 2i \Im(\tau) \\
= \quad & S \Im(\tau) > 0 ,
\end{align*}
%TODO: \nu(M'), warum ist das immer 1?
thus $S \tau \in \HalfPlane_2$. Thus, $\tau \mapsto f(S \tau)$ is a function $\HalfPlane_1 \rightarrow \C$.

Let $l := \det(S)$. That is the denominator of $S^{-1}$. Let $\SmallMatrix{a}{b}{c}{d} \in \Gamma_0(l) \subseteq \SL_2(\Z)$. We have
\begin{align*}
& S \frac{a \tau + b}{c \tau + d} \\
=\quad & (a (S \tau) + bS) \cdot ((c S^{-1}) (S \tau) + d)^{-1} \\
=\quad & \SimpleMatrix{a 1_2}{b S}{c S^{-1}}{d 1_2} \cdot S \tau .
\end{align*}
Define
\[ M := \SimpleMatrix{a 1_2}{b S}{c S^{-1}}{d 1_2} \in \M_4(\C) . \]
With $l | c$, we also have $c S^{-1} = \frac{c}{l} [u, -t, s] \in \M_2(\curlO)$, thus we have $M \in \M_4(\curlO)$.
Recall that we have $S = \overline{S}^T$ and $ad  - bc = 1$. Verify that we have $M \in \Sp_2(\curlO) = \Gamma^H$:
\begin{align*}
&  \overline{M}^T J_2 M \\
=\quad & \overline{\SimpleMatrix{a 1_2}{b S}{c S^{-1}}{d 1_2}}^T J_2 \SimpleMatrix{a 1_2}{b S}{c S^{-1}}{d 1_2} \\
=\quad & \SimpleMatrix
{(-ac S^{-1} + ac \overline{S^{-1}}^T)}
{(-ad 1_2 + cb \overline{S^{-1}}^T S)}
{(-bc \overline{S}^T S^{-1} + ad 1_2)}
{(-bd \overline{S}^T + bd S)} \\
=\quad & J_2 .
\end{align*}

Thus, because $f$ is a Hermitian modular form, we have
\begin{align*}
& f\left(S \frac{a \tau + b}{c \tau + d} \right) \\
=\quad & f\left( M \cdot S \tau \right) \\
=\quad & \nu(M) \cdot \det(c S^{-1} S \tau + d 1_2)^k \cdot f(S \tau) \\
=\quad & (c \tau + d)^{2k} \cdot f(S \tau) .
\end{align*}
Thus, $f$ is an Elliptic modular form of weight $2k$ to $\Gamma_0(l)$.
\endproof
\end{lemma}


% TODO: wofür brauchen wir das?
% von Notizen im Block
% Prop 7.3 von Poor für herm Modulformen
\begin{lemma}
Prop 7.3. von Poor für herm Modulformen.
$\Gamma(\mathcal{L}) \supseteq \Gamma_0(l)$ for $l \in \Z^+, ls^{-1} \in \mathcal{P}_n(\curlO)$.
% \Gamma ist kein Gitter, sondern eine diskrete Untergruppe
% Beweisskizze in Unterlagen
% L symmetrische, ganze Matrix => \Gamma(L) \subseteq \SL{2}(\ZZ)
% \curlL ist ein polarisiertes Gitter, welches wir zur Vereinfachung als gewöhliche symmetrische, ganz Matrix ansehen
\end{lemma}


We want to calculate a generating set for the Fourier expansions of Hermitian modular forms. Now we will formulate the main algorithm of our work.

\begin{algo}
We have the Hermitian modular form degree $n = 2$ fixed, as well as some $\Delta$ (for now, $\Delta \in \Set{3,4,8}$). Then we select some form weight $k \in \Z$ ($k \in \Set{1,\dots,20}$ or so), let $\curlO \subseteq \Q(\sqrt{-\Delta})$ be the maximum order (see chapter \ref{maxorder}) and some subgroup $\Gamma$ of $\Sp_2(\curlO)$. Then we select an abel character $\nu \colon \Gamma \rightarrow \C^\times$ of $\Sp_2(\curlO)$.

We define the index set
\[ \Lambda := \Set{0 \le \SimpleMatrix{a}{b}{\overline b}{c} \in \M_2(\curlO^\#)}{a,c \in \Z } . \]

Fix $B \in \N$ as a limit. Select a precision
\[ \F := \Set{\SimpleMatrix{a}{b}{\overline b}{c} \in \Lambda}{0 \le a , c < B} \subseteq \Lambda . \]
% \Lambda sind die die Indizes der Fourier-Entwicklung einer Hermitischen Modulform.

\begin{enumerate}
%or: http://www.latex-community.org/forum/viewtopic.php?f=4&t=2209
%\renewcommand{\theenumi}{Step \arabic{enumi}}
\item We start with $l = 1$ and increase it but only use the square-free numbers.
\item Set $\mathcal{S} = \{\}$,
\item\label{NextSStep} Enumerate matrices $S \in \M_2^T(\Z)$, and set $\mathcal{S} \leftarrow \mathcal{S} \cup \{ S \}$ and for each time you add a new matrix perform the following steps.

%Select a set of matrices $\mathcal{S} \subseteq \M_2^T(\Z)$ with $0 < S \in \mathcal{S}$.
%Make $\mathcal{S}$ big enough.
%Now, for some $S \in \mathcal{S}$:

\item
\newcommand{\FPrecisionLimit}[1]{\F(#1)}
We set
\[ \mathcal{M}_{k,\mathcal{S},\F}^H := \Set{ (a [S])_{S\in\mathcal{S}} }{\text{$a \in \Q^\F$ is $\GL_2(\curlO)$ invariant}} \subseteq \bigoplus_{S\in\mathcal{S}} \Q^{\FPrecisionLimit{S}} , \]
where
\[ a[S] := \N_0 \rightarrow \Q, n \mapsto \sum_{T \in \Lambda, \tr(S T) = n} a(T), \]
The elements $a \in \Q^\F$ are Fourier expansions of Elliptic modular forms ($\HalfPlane_1 \rightarrow \C$) and $a(T) \in \Q$ for $T \in \F \subseteq \M_2(\curlO^\#)$ are the Fourier coefficients.
Recall that $a$ being invariant under $\GL_2(\curlO)$ means that we have
\[ \det(U)^k a(T[U]) = a(T) \; \forall\ U \in \GL_2(\curlO) . \]
With $[a,b,c] \in \F$, we have $0\le a,c<B$, thus there are only a finite number of possibilities. Because $0 \le [a,b,c]$, we get $ac - \left| b \right|^2 \ge 0$ and thus $b$ is also always limited. Thus, $\F$ is finite but it might be huge for even small $B$. % TODO: actual numbers
Restricting the elements in $\F$ by the $\GL_2(\curlO)$-invariation makes the set $\invar{\F}{\GL_2(\curlO)} \subseteq \F$ much smaller and better to handle in computer calculations. We use this set to identify a base of the finite dimension vector space $\invar{\Q^\F}{\GL_2(\curlO)}$.

We identify
% Das ist der Bildbereich der Abbildung.
\[ \bigoplus_{S\in\mathcal{S}} \Q^{\FPrecisionLimit{S}} = \Q^N, \ \ N = \sum_{S\in\mathcal{S}} \FPrecisionLimit{S} . \]
For a given $S \in \mathcal{S}$ and limit $B \in \N$ which restricts $\F \subset \Lambda$, $\FPrecisionLimit{S} \in \N_0$ is the limit such that for any $T \in \Lambda - \F$, $\tr(S T) \ge \FPrecisionLimit{S}$. Thus, for calculating the Fourier coefficients $T \in \Lambda$ with $\tr(S T) \in \Set{0, \dots, \FPrecisionLimit{S} - 1}$, it is sufficient to enumerate the $T \in \F$.

Let $S = [s,t,u]$ and $T = [a,b,c]$. Recall that $S \in \M_2^T(\Z)$. Then we have
\[ \tr(S T) = as + \overline{t} b + t \overline{b} + cu = as + cu + 2 t \Re(b) . \]
Because $T \ge 0$, we have $ac \ge \left| b \right|^2$ and thus $\Re(b) \le \sqrt{ac} \le \max(a,c)$. Thus, $2t \Re(b) \ge -2 \left| t \right| \max(a,c)$. We also have $as + cu \ge \max(a,c) (s + u)$. Assuming $T \in \Lambda - \F$, we have $\max(a,c) \ge B$. For such $T$, we get
\[ \tr(ST) \ge B \cdot (s + u - 2 \left| t \right|) . \]
Given $S > 0$, we have $su > t^2$. Then we have
\begin{align*}
& s + u - 2 \left| t \right| > 0 \\
\Leftrightarrow \quad & su + u^2 - 2 \left| t \right| u > 0 \\
\Leftrightarrow \quad & \left( t^2 + u^2 - 2 \left| t \right| u \right) + (su - t^2) > 0 \\
\Leftrightarrow \quad & \left(\left| t \right| - u \right)^2 + (su - t^2) > 0 .
\end{align*}
All inequalities were sharp estimations\footnote{For example, let $S=[2,-1,1]$. Then you have $s+u-2 \left| t \right| = 1$. With $c=B$ and $a=b=1$, you hit the limit $\tr(S T) = 2 + B - 2 = B = \FPrecisionLimit{S}$. }, %
thus we get
\[ \FPrecisionLimit{S} = B \cdot (s + u - 2 \left| t \right|) . \]

We want to calculate the matrix of the linear function \[
\invar{\Q^\F}{\GL_2(\curlO)} \rightarrow \bigoplus_{S\in\mathcal{S}} \Q^{\FPrecisionLimit{S}}, \ \ 
a \mapsto (a[S])_{S\in\mathcal{S}} .
\]
The base of the destination room is canonical. The dimension is $N$.
The base of the source room can be identified by $\invar{\F}{\GL_2(\curlO)}$.

And we set
\[ \mathcal{M}_{k, \mathcal{S},\F} := \bigoplus_{S\in\mathcal{S}} \FE_{\F(S)}(\ESpace{k}{\Gamma_0(l_S)}) \]
where $\ESpace{k}{\Gamma_0(l_S)}$ is the vectorspace of Elliptic modular forms over $\Gamma_0(l_S)$. % Köcher-Krieg II.3

\item
If
\[ \dim \mathcal{M}_{k,\mathcal{S},\F}^H \cap \mathcal{M}_{k, \mathcal{S},\F}
= \dim \HSpace{k}{\Gamma,\nu} , \]
then we are ready and we can reconstruct the Fourier expansion in the following way: ...

If not, then return to step \ref{NextSStep}, and enlarge $\mathcal{S}$.
\end{enumerate}
\end{algo}

%Matrix-repr of f \in (\Q^{\CurlfF[G]})^G_Chi \mapsto (\sum_{tr(ST)=n} a(T))_{n,S}
%( )^{G, chi} meine ich die Menge der Elemente von Q^\cF[G], die a(T[g]) = chi(g) a(T) erfüllen
% Eine Basis davon kannst du dir mittels der Reduktionen von T überlegen
